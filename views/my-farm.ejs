<%- include("partials/header.ejs") %>

<section class="page-header">
  <div class="container">
    <h1 class="page-title"><i class="fas fa-tractor"></i> My Farm</h1>
    <p class="page-subtitle">Your shop profile and farm details</p>
    <nav class="breadcrumb">
      <a href="/" class="breadcrumb-link">Home</a>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-current">My Farm</span>
    </nav>
  </div>
</section>

<section class="seller-application" style="padding-top:20px;">
  <div class="container">
    <% if (!farm) { %>
      <div class="info-card" style="padding:16px;">
        <h3>No farm profile yet</h3>
        <p>Please create your shop to see farm details.</p>
        <a href="/create-shop" class="btn btn-primary">Create Shop</a>
      </div>
    <% } else { %>
      <div class="application-container" style="align-items:flex-start;">
        <div class="application-form-card" style="width:60%;">
          <h2 class="auth-title">Farm Details</h2>
          <ul class="detail-list">
            <li><strong>Farm Name:</strong> <%= farm.farm_name || '—' %></li>
            <li><strong>District:</strong> <%= farm.district || '—' %></li>
            <li><strong>Address:</strong> <%= farm.address || '—' %></li>
            <li><strong>Location:</strong> <%= farm.location || '—' %></li>
            <li><strong>Farm Size:</strong> <%= farm.farm_size ? farm.farm_size + ' acres' : '—' %></li>
            <li><strong>Products:</strong> <%= farm.products || '—' %></li>
            <li><strong>Experience:</strong> <%= farm.experience || '—' %></li>
            <li><strong>Verified:</strong> <%= farm.is_verified ? 'Yes' : 'No' %></li>
            <li><strong>Rating:</strong> <%= farm.rating || 0 %> (<%= farm.total_reviews || 0 %> reviews)</li>
            <li><strong>Updated:</strong> <%= farm.updated_at ? new Date(farm.updated_at).toLocaleDateString() : '—' %></li>
          </ul>

          <h3 class="form-section-title" style="margin-top:16px;">Banking</h3>
          <ul class="detail-list">
            <li><strong>Bank Name:</strong> <%= farm.bank_name || '—' %></li>
            <li><strong>Account Number:</strong> <%= farm.account_number || '—' %></li>
            <li><strong>Account Holder:</strong> <%= farm.account_holder_name || '—' %></li>
            <li><strong>Mobile Banking:</strong> <%= farm.mobile_banking_provider || '—' %></li>
            <li><strong>Mobile Number:</strong> <%= farm.mobile_banking_number || '—' %></li>
          </ul>
        </div>

        <div class="application-info" style="width:38%;">
          <div class="info-card">
            <h3>Farm Picture</h3>
            <div style="border:1px dashed #cbd5e0; border-radius:8px; padding:12px; text-align:center; background:#f8fafc;">
              <div style="font-size:48px; color:#cbd5e0;">
                <i class="fas fa-image"></i>
              </div>
              <p style="margin:8px 0 4px;">Add a farm photo</p>
              <small style="color:#6b7280;">(Upload handling not implemented)</small>
              <div style="margin-top:10px;">
                <a href="#" class="btn btn-outline" aria-disabled="true">Upload (coming soon)</a>
              </div>
            </div>
          </div>

          <div class="info-card">
            <h3>Tips</h3>
            <ul class="tips-list">
              <li>Use a clear farm exterior photo</li>
              <li>Keep your address and bank info up to date</li>
              <li>List your main products for quicker approval</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="info-card" style="margin-top:20px;">
        <h2 class="auth-title" style="font-size:20px;">Your Products</h2>
        <% if (!products || products.length === 0) { %>
          <p>No products yet. <a href="/add-product" class="link-primary">Add your first product</a>.</p>
        <% } else { %>
          <div class="product-grid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(220px, 1fr)); gap:12px;">
            <% products.forEach(p => { %>
              <div class="product-card" style="border:1px solid #e5e7eb; border-radius:10px; padding:12px; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.04);">
                <div style="height:140px; background:#f8fafc; border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden; margin-bottom:8px;">
                  <% if (p.image_url) { %>
                    <img src="<%= p.image_url %>" alt="<%= p.name %>" style="max-height:140px; max-width:100%; object-fit:cover;">
                  <% } else { %>
                    <i class="fas fa-image" style="color:#cbd5e0; font-size:32px;"></i>
                  <% } %>
                </div>
                <h4 style="margin:0 0 6px; font-size:16px;"> <%= p.name %> </h4>
                <p style="margin:0 0 4px; color:#4b5563;">Category: <%= p.category || '—' %></p>
                <p style="margin:0 0 4px; color:#111; font-weight:600;">BDT <%= Number(p.price).toFixed(2) %> / <%= p.unit || '' %></p>
                <p style="margin:0 0 4px; color:#4b5563;">Stock: <%= p.stock_quantity %></p>
                <p style="margin:0;">
                  <% if (p.is_verified) { %>
                    <span style="color:#16a34a;">Status: Verified</span>
                  <% } else { %>
                    <span style="color:#9ca3af;">Status: Pending</span>
                  <% } %>
                </p>
              </div>
            <% }) %>
          </div>
        <% } %>
      </div>
    <% } %>
  </div>
</section>

<%- include("partials/footer.ejs") %>
