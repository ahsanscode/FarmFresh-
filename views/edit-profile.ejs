<%- include("partials/header.ejs") %>

<section class="page-header">
  <div class="container">
    <h1 class="page-title"><i class="fas fa-user-edit"></i> Edit Profile</h1>
    <p class="page-subtitle">Update your account details</p>
  </div>
</section>

<section class="auth-page">
  <div class="container">
    <div class="auth-container">
      <div class="auth-card" style="max-width: 640px;">
        <h2 class="auth-title">Account Information</h2>
        <form class="auth-form" action="/profile/edit" method="post">
          <div class="form-row">
            <div class="form-group">
              <label for="name">Full Name</label>
              <input type="text" id="name" name="name" value="<%= userData?.name || '' %>" required>
            </div>
            <div class="form-group">
              <label for="email">Email (read-only)</label>
              <input type="email" id="email" value="<%= userData?.email || '' %>" readonly>
            </div>
          </div>

          <div class="form-group">
            <label for="phone">Phone</label>
            <input type="tel" id="phone" name="phone" value="<%= userData?.phone || '' %>" placeholder="+880 1XXX-XXXXXX">
          </div>

          <div class="form-group">
            <label for="avatarFile">Profile Picture</label>
            <input type="file" id="avatarFile" accept="image/*">
            <small class="form-hint">Preview only. Upload functionality can be added later.</small>
          </div>

          <% if (farmer) { %>
            <h2 class="auth-title" style="margin-top: 16px;">Farm Information</h2>
            <div class="form-group">
              <label for="farm_name">Farm/Business Name</label>
              <input type="text" id="farm_name" name="farm_name" value="<%= farmer.farm_name || '' %>">
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="district">District</label>
                <input type="text" id="district" name="district" value="<%= farmer.district || '' %>">
              </div>
              <div class="form-group">
                <label for="farm_size">Farm Size (acres)</label>
                <input type="number" id="farm_size" name="farm_size" min="0" step="0.1" value="<%= farmer.farm_size || '' %>">
              </div>
            </div>
            <div class="form-group">
              <label for="address">Address</label>
              <textarea id="address" name="address" rows="3"><%= farmer.address || '' %></textarea>
            </div>
          <% } %>

          <div class="actions" style="display:flex; gap:8px;">
            <button type="submit" class="btn btn-primary">Save Changes</button>
            <a href="/profile" class="btn btn-outline">Cancel</a>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
  const avatarFile = document.getElementById('avatarFile');
  avatarFile?.addEventListener('change', function() {
    const file = this.files?.[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (e) => {
      // Could preview in a modal or swap a header avatar if present
      alert('Preview ready. Upload functionality can be added later.');
    };
    reader.readAsDataURL(file);
  });
</script>

<%- include("partials/footer.ejs") %>